Добавляю схему ранее созданного кода:
https://kodaktor.ru/j/myjsnon_87589 (схема)
https://kodaktor.ru/j/myjsnon_2f099 (код)

Предлагаю грамматику вида C ➞ (CC) | (C) | (e)

Для проверки принципа правильной вложенности можно использовать принцип работы стэка, а конкретно принцип LIFO, last in first out, таким образом каждая открытая скобка остается в стэке до того момента, пока соответствующая ей закрывающая не будет задействована.
